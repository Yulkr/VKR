import pandas as pd
import matplotlib.pyplot as plt
from io import StringIO

# Повторно загружаем данные после сброса состояния
csv_data = """
tick,avg_delay,legit_tx_count
0,-157.0,1
0,-188.5,2
0,-202.66666666666666,3
0,-238.5,4
0,-230.2,5
0,-237.0,6
0,-262.0,7
0,-265.75,8
0,-250.33333333333334,9
0,-249.4,10
0,-265.72727272727275,11
0,-248.33333333333334,12
0,-235.6153846153846,13
0,-228.0,14
0,-239.6,15
0,-247.0625,16
0,-245.2941176470588,17
0,-234.88888888888889,18
0,-226.78947368421052,19
0,-220.85,20
0,-229.47619047619048,21
0,-241.6818181818182,22
0,-234.17391304347825,23
0,-243.66666666666666,24
0,-243.84,25
0,-245.1153846153846,26
0,-236.77777777777777,27
0,-230.25,28
0,-225.9655172413793,29
0,-228.56666666666666,30
0,-229.51612903225808,31
0,-228.0,32
0,-230.87878787878788,33
0,-227.44117647058823,34
0,-222.8,35
0,-222.8,35
0,-222.8,35
0,-222.8,35
0,-222.8,35
0,-222.8,35
0,-222.8,35
0,-222.8,35
0,-222.8,35
0,-222.8,35
0,-222.8,35
0,-222.8,35
0,-222.8,35
0,-222.8,35
0,-222.8,35
"""

# Загрузка данных в DataFrame
df = pd.read_csv(StringIO(csv_data))

# Построение графика
plt.figure(figsize=(10, 6))
plt.plot(df['legit_tx_count'], df['avg_delay'], marker='o')
plt.title('Зависимость средней задержки от количества легитимных транзакций')
plt.xlabel('Количество легитимных транзакций')
plt.ylabel('Средняя задержка (ед. времени)')
plt.grid(True)
plt.tight_layout()
plt.show()

# Расчёт итоговой статистики
summary_stats = df['avg_delay'].describe()
summary_stats_df = pd.DataFrame(summary_stats)

import ace_tools as tools; tools.display_dataframe_to_user(name="Итоговая статистика по задержкам", dataframe=summary_stats_df)
