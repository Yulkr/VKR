dtmc

// Константы модели (улучшенная версия)
const int N = 10;     // Увеличенное начальное преимущество честной цепочки (число подтверждений)
const int MAX_Z = 15; // Порог неуспеха атаки в улучшенной модели
const double q = 0.3; // Доля вычислительной мощности атакующего
const double p = 1 - q; // Доля вычислительной мощности честных майнеров

module double_spend_improved
    // Переменная z: разница между числом блоков честной цепочки и цепочки атакующего.
    // Начальное значение z = N, где N увеличено по сравнению с базовой моделью.
    z : [-1..MAX_Z] init N;
    
    [] z = -1 -> (z' = -1);      // Состояние успеха атаки
    [] z = MAX_Z -> (z' = MAX_Z);  // Состояние неуспеха атаки
    
    // Переходы аналогичны базовой модели:
    [] z >= 0 & z < MAX_Z -> q : (z' = z - 1) + p : (z' = min(z + 1, MAX_Z));
endmodule

// Метки для анализа
label "success" = z = -1;
label "fail" = z = MAX_Z;
